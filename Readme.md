# Tez Admin

This is a frontend app for admins and managers. Here will be shown how to start and build an app, also this readme file contains code and style guides.
### Table of contents
- [How to run an app](#how-to-run-an-app)
- [How to build an app](#how-to-build-an-app)
- [Code guide for Tez Admin](#code-guide-for-tez-admin)
- [Style guide for Tez Admin](#style-guide-for-tez-admin)

> This project uses Gulp as a task manager, so if you are not familiar with it, please checkout this tutorial on [CSS Tricks]. Also the boilerplate for app was generated by [Yeoman] with **generator-gulp-angular**, check their [github] for more detailed description


### How to run an app
1) Go to the project's root folder
2) Open cmd in that folder and run:
```sh
gulp serve
```
Gulp will bootstrap an application in a *developer environment* and open it in your browser. All changes in `/src` folder will be immideately displayed in browser. 

### How to build an app
Just run:
```
gulp build
```
Gulp will run the `build` task that will concatinate and minify all `.js` scipts and `.scss` files from `\src\app` and `\bower_components`  in two files for both *scripts* and *styles* like:

##### JS:

- `app-fff3fd3484.js`
- `vendor-42eadd8656.js`

##### CSS:

- `app-c7f158490a.css`
- `vendor-fabce0b912.css`

Application will be build into `\dist` folder.

> **Note!** 
>This app has `gulp-inject` module, so it automatically injecting all scripts and stylesheets in `index.html` file. Do not do this manually, exeption for **third party libs**, that injects by `<script>` tag, e.g. `google maps`.

## Code guide for Tez Admin

>***Note!*** It is strong recommended to follow [Angular styleguide]. Please read about defining a modules, controllers, directives and services first before you begin to write a code.
#### File structure:
```
|--src
|    |--app
|    |--index.module.js // adminApp module (main module)
|    |--index.*.js // adminApp's settings like 'route'
|    |--index.scss // Main SCSS file
|    |    |--bundle // Stylesheets and non-angular js
|    |    |    |--scripts
|    |    |    |--styles // SCSS reusable components like 'buttons' etc.
|    |    |    |   |--base
|    |    |    |   |--utils
|    |    |    |   |--components
|    |    |--components // Angular components used in app 
|    |    |--main // Main controller
|    |--assets
|    |    |--translations
|    |    |--images
```
#### Naming convention for angular files:
Each module must have it's own directory and all files inside must begin with directory name and it's purpose, `e.g`:
```
|--trips
|    |--trips.module.js
|    |--trips.controller.js
|    |--trips.service.js
|    |--trips.directive.js
|    |--trips.scss
```

#### Example:

>***Note!*** App has `ng-annotate` gulp module, it automatically set dependency injection into file, just add `@ngInject` in comment above injectable function

``` javascript
/** @ngInject */    
    function TripsController(TripsService, $log) {
    
    }
```

##### Module 
`trips.module.js`

Each angular file must be wrapped by anonymous self-invoking function. 
```
(function() {
    'use strict';
})();
```
Do not assign a variable to module.
``` javascript
//Not recommened
var app = angular.module('yourModule');
app.controller('SomeController', SomeController);

function SomeController() {}
```

``` javascript
//Recommended
angular
    .module('yourModule', []);
    .controller('SomeController', SomeController);
    
function SomeController() {}
```

``` javascript
(function () {
    "use strict";

    angular
        .module("adminApp.trips", ['ui.router', 'toastr'])
        .config(tripsConfig)
        
    /** @ngInject */    
    function tripsConfig($stateProvider) {
        $stateProvider.state('trips', {
            url: '/trips',
            templateUrl: 'app/components/trips/trips.html',
            controller: 'TripsController',
            controllerAs: 'trips',
            data: {
                requiresLogin: true
            }
        });
    }
})();
```
>***Note!*** App using `ui-router` and it's `$stateProvider`, learn more in official documentation on their [page]

When defining a route use `controllerAs` syntax for `controller`. It helps avoid the temptation of using `$scope` methods inside a `controller` when it may otherwise be better to avoid them or move the method to a `factory`, and reference them from the `controller`. Consider using `$scope` in a `controller` only when needed. 
##### Controller
`trips.controller.js`

Use a capture ***variable*** for `this` when using the `controllerAs` syntax. Choose a consistent variable name such as `vm`, which stands for `ViewModel`.

The `this` keyword is contextual and when used within a function inside a `controller` may change its context. Capturing the context of this avoids encountering this problem.

``` javascript
(function () {
    "use strict";

    angular
        .module('adminApp.trips')
        .controller('TripsController', TripsController);
    
    /** @ngInject */
    function TripsController(TripsService, $log) {
        var vm = this;
        vm.mainVariable = 42;
    }
})();
```
And in view:
```
<div class='trips'>{{ trips.mainVariable }}</div>
```
##### Service 
`trips.service.js`

``` javascript
(function () {
    "use strict";
    angular
        .module('adminApp.trips')
        .service('TripsService', TripsService);
        
    /** @ngInject */
    function TripsService($http) {
        var api_uri = "http://mycoolapi.com";
        this.getTrips = function() {
            return $http({
                method: 'GET',
                url: api_uri,
                headers: {
                    'Accept': 'application/json',
                    'Authorization': 'Bearer ' + (localStorage.getItem("jwt")
                }
            });
        }
    }

})();
```

##### Directive 

`trips.tabs.directive.js`
``` javascript
(function () {
    "use strict";
    
    angular
        .module('adminApp.trips')
        .directive('tabs', tabs);

    /** @ngInject */
    function Tabs($compile, $timeout, $log, toastr) {
        var directive = {
            restrict: 'E',
            templateUrl: 'app\components\trips\directive\tabs.html' ,
            replace: true,
            scope: {},
            link: linkFunction
        };

        return directive;

        function linkFunction($scope, $element, $attrs) {
            // Stuff here
        }
    })();
```
# Style guide for Tez Admin
## Markup

It is strong recommended to use `BEM` metodology to define blocks. Please read the documentation on [Yandex] or tutorial [BEM-101] on CSS-Tricks.

#### HTML example

``` html
<div class="profile profile--default-user">
    <div class="profile__meta">
        <img src="photo.jpg" class="profile__photo">
    </div>
    <div class="profile__meta">
        <p class="profile__name">
            John
        </p>
        <p class="profile__lastname">
            Doe
        </p>
        <p class="profile__phone">
            0555 707 707
        </p>
    </div>
    <button class="btn btn--primary"> Edit </button>
</div>
```
Parent `div` starts with class `profile` - this is a `block` in BEM notation. And all things inside it - it's elements. 
 Elements define with double underscore `block__element`.

You can't use `elements` without it's 'parent'. But you free to add another `block` inside outer `block`. As you can see `btn` is another `block` here. 

To add some modifications or behaviour to `block` or `element` you have to use `modifiers`. Modifiers define with double dashes `block--modifier`.

## Presentation
#### SCSS
Tez Admin use SASS language as css preprocessor with `gulp-sass`. If you not familiar with SASS, please read the official docs on [sass-lang.com]

There is a folder for core style elements, it contains `colors` that using in project, `mixins` and `functions` to make our life a little bit easier, also it contains `components` - it is reusable things like `buttons`, let's take a look:
```
/* src\app\bundle\styles */

|--styles
|   |--base
|   |   | _colors.scss
|   |--components
|   |--utils
|   |   | _functions.scss
|   |   | _mixins.scss
|   |   | _variables.scss
```

Each angular module has it's own `_module-name.scss` file. All modules and components includes in main `index.scss`:
```
@import 'components/module-name/module-name';
@import 'components/module-name/directives/module-name.directive-one';
```

#### How to write in SCSS and BEM

Let's take our HTML example above and write styles for it. Suppose that it is on a `trips.scss`:
``` scss
/* define a block */ 
.profile {
    display: block;
    width: 100%;
    /* to define an element just use `&` in a parent block and two underscores, same things for modifier with two dashes */
    &--default-user {
        /*  while working with colors use only SASS function `palette`
            `mono` is an object with grayscale colors
            `brand` is an object with non-grayscale colors
            all available colors you can find in `_colors.scss`
        */
        background: palette(mono, lighter);
    }
    &__meta {
        display: inline-block;
    }
    &__name {
        font-size: .8rem;
        color: palette(mono, dark);
        /* to define a state for an element also use `&`*/
        &:hover {
            background: palette(mono, light);
        }
    }
}
```

The output will be:
``` css
.profile {
  display: block;
  width: 100%;
}
.profile--default-user {
  background: #ddd;
}
.profile__meta {
  display: inline-block;
}
.profile__name {
  font-size: .8rem;
  color: #333;
}
.profile__name:hover {
  background: #aaa;
}

```
[//]: # (These are reference links used in the body of this note and get stripped out when the markdown processor does its job. There is no need to format nicely because it shouldn't be seen. Thanks SO - http://stackoverflow.com/questions/4823468/store-comments-in-markdown-syntax)

   [yeoman]: http://yeoman.io/
   [github]:https://github.com/Swiip/generator-gulp-angular/blob/master/docs/user-guide.md
   [CSS Tricks]: https://css-tricks.com/gulp-for-beginners/
   [Angular styleguide]: https://github.com/johnpapa/angular-styleguide/tree/master/a1/
   [page]: https://github.com/angular-ui/ui-router/wiki
   [sass-lang.com]: http://sass-lang.com/documentation/file.SASS_REFERENCE.html
   [Yandex]: https://en.bem.info/methodology/key-concepts/
   [BEM-101]:https://css-tricks.com/bem-101/


